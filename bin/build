#!/bin/bash

case "$2" in
    -w)
        TASK="watch"
    ;;

    *)
        TASK="build"
    ;;
esac

case "$1" in
    dev)
        rm -rf app/Resources/public/node_modules
        rm -rf app/cache/dev
        composer install --no-interaction
        npm install
        node_modules/.bin/jspm install --log warn --yes
        node_modules/.bin/gulp ${TASK} --env=dev
    ;;

    prod)
        rm -rf app/cache/prod
        composer install
        npm install
        node_modules/.bin/jspm install --log warn --yes
        node_modules/.bin/gulp ${TASK} --env=prod
    ;;

    *)
        echo -e "Usage: bin/build <dev|prod> [-w]";
    ;;
esac
